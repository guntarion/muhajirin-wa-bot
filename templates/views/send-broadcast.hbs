<div>
    <h1>Kirim Pesan Broadcast</h1>
</div>

<div class="container">
    <form id="broadcastForm">
        <div class="form-group">
            <label for="broadcastNama">Nama Sesi Broadcast:</label>
            <input type="text" id="broadcastNama" class="form-control" required>
        </div>
        <div class="form-group">
            <label for="groupSelect">Pilih Group:</label>
            <select id="groupSelect" class="form-control" required>
                <option value="">Select a Group</option>
                {{#each groups}}
                <option value="{{groupId}}">{{groupName}}</option>
                {{/each}}
            </select>
        </div>
        <div class="form-group">
            <label for="messageText">Pesan:</label>
            <textarea id="messageText" class="form-control" rows="4" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Kirim Pesan</button>
    </form>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.getElementById('broadcastForm').addEventListener('submit', async function (event) {
            event.preventDefault();
            const broadcastNama = document.getElementById('broadcastNama').value;
            const groupId = document.getElementById('groupSelect').value;
            const messageText = document.getElementById('messageText').value;
            console.log('Broadcast Nama:', broadcastNama);
            console.log('Group ID:', groupId);
            console.log('Message:', messageText);

            if (!groupId) {
                alert('Please select a group');
                return;
            }

            try {
                const response = await fetch('/api/send-group-message', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ groupId, message: messageText, broadcastNama })
                });
                const result = await response.json();
                console.log('Response:', result);
            } catch (error) {
                console.error('Error sending group message:', error);
            }
        });
    });
</script>